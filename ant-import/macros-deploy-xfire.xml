<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!--                                                                        -->
<!--  JBoss, the OpenSource J2EE webOS                                      -->
<!--                                                                        -->
<!--  Distributable under LGPL license.                                     -->
<!--  See terms of license at http://www.gnu.org.                           -->
<!--                                                                        -->
<!-- ====================================================================== -->

<!-- $Id$ -->

<project>

  <!-- ================================================================== -->
  <!-- Deployment                                                         -->
  <!-- ================================================================== -->
  
  <!-- Deploy to jboss50 -->
  <macrodef name="macro-deploy-xfire50">
      <attribute name="wsflibs"/>
      <attribute name="stacklibs"/>
      <attribute name="thirdpartylibs"/>
    <sequential>
      <fail message="Not available: ${jboss50.available.file}" unless="jboss50.available"/>

			<!-- CLIENT JARS -->
      <copy todir="${jboss50.home}/client" overwrite="true">
        <fileset dir="@{wsflibs}">
          <include name="jbossws-framework.jar"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <include name="jbossws-jboss50.jar"/>
          <include name="jaxb-api.jar"/>
          <include name="jaxb-impl.jar"/>
          <include name="jaxb-xjc.jar"/>
        </fileset>
      </copy>
      
			<!-- BOOTSTRAP JARS -->
			<copy todir="${jboss50.home}/lib" overwrite="true">
				<fileset dir="@{thirdpartylibs}">
					<include name="jaxb-api.jar"/>
					<include name="jaxb-impl.jar"/>
				</fileset>
			</copy>
			
			<!--SERVER JARS -->
      <copy todir="${jboss50.home}/server/${jboss.server.instance}/lib" overwrite="true">
				<fileset dir="@{thirdpartylibs}">
          <include name="jbossws-jboss50.jar"/>
					<include name="jaxws-api.jar"/>
					<include name="saaj-api.jar"/>
				</fileset>
      </copy>
      
      <mkdir dir="${jboss50.home}/server/${jboss.server.instance}/deployers/jbossws.deployer"/>
      <unzip dest="${jboss50.home}/server/${jboss.server.instance}/deployers/jbossws.deployer" src="@{thirdpartylibs}/jbossws-jboss50-deployer.zip"/>
      <mkdir dir="${jboss50.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar"/>
      <unjar dest="${jboss50.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar" src="@{stacklibs}/jbossws-xfire50.sar"/>      
			<!-- Deploy juddi-service.sar -->
			<mkdir dir="${jboss50.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
			<unzip dest="${jboss50.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
    
  <!-- Undeploy from jboss50 -->
  <macrodef name="macro-undeploy-xfire50">
    <sequential>
      <delete>

  			<!-- CLIENT JARS -->
        <fileset dir="${jboss50.home}/client">
          <include name="jbossws-framework.jar"/>
          <include name="jbossws-spi.jar"/>
          <include name="jbossws-jboss50.jar"/>
        </fileset>
        
        <!-- BOOTSTRAP JARS -->
        <fileset dir="${jboss50.home}/lib">
          <include name="jaxb-api.jar"/>
          <include name="jaxb-impl.jar"/>
        </fileset>
			
  			<!--SERVER JARS -->
        <fileset dir="${jboss50.home}/server/${jboss.server.instance}/lib">
          <include name="jbossws-jboss50.jar"/>
        </fileset>
      </delete>
      
      <delete dir="${jboss50.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar"/>
			<!-- Undeploy juddi-service.sar -->
			<delete dir="${jboss50.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
  <macrodef name="macro-deploy-xfire42">
      <attribute name="wsflibs"/>
      <attribute name="stacklibs"/>
      <attribute name="thirdpartylibs"/>
    <sequential>
      <fail message="Not available: ${jboss42.available.file}" unless="jboss42.available"/>

			<!-- CLIENT JARS -->
      <copy todir="${jboss42.home}/client" overwrite="true">
        <fileset dir="@{wsflibs}">
          <include name="jbossws-framework.jar"/>
        </fileset>
        <fileset dir="@{thirdpartylibs}">
          <include name="jbossws-jboss42.jar"/>
          <include name="jbossws-spi.jar"/>
          <include name="jaxb-api.jar"/>
          <include name="jaxb-impl.jar"/>
          <include name="jaxb-xjc.jar"/>
          <include name="resolver.jar"/>
        </fileset>
      </copy>
      
			<!-- BOOTSTRAP JARS -->
      <copy todir="${jboss42.home}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <include name="jaxb-api.jar"/>
          <include name="jaxb-impl.jar"/>
        </fileset>
      </copy>
			
			<!--SERVER JARS -->
      <copy todir="${jboss42.home}/server/${jboss.server.instance}/lib" overwrite="true">
        <fileset dir="@{thirdpartylibs}">
          <include name="jbossws-jboss42.jar"/>
        </fileset>
      </copy>
      
      <mkdir dir="${jboss42.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar"/>
      <unjar dest="${jboss42.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar" src="@{stacklibs}/jbossws-xfire42.sar"/>
			<!-- Deploy juddi-service.sar -->
			<mkdir dir="${jboss42.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
			<unzip dest="${jboss42.home}/server/${jboss.server.instance}/deploy/juddi-service.sar" src="@{thirdpartylibs}/juddi-service.sar"/>
    </sequential>
  </macrodef>
    
  <!-- Remove jbossws/xfire from jboss42 -->
  <macrodef name="macro-undeploy-xfire42">
    <sequential>
      <delete>

  			<!-- CLIENT JARS -->
        <fileset dir="${jboss42.home}/client">
          <include name="jbossws-spi.jar"/>
          <include name="jbossws-jboss42.jar"/>
          <include name="resolver.jar"/>
        </fileset>
        
  			<!--SERVER JARS -->
        <fileset dir="${jboss42.home}/server/${jboss.server.instance}/lib">
          <include name="jbossws-jboss42.jar"/>
        </fileset>
      </delete>
      
      <delete dir="${jboss42.home}/server/${jboss.server.instance}/deploy/jbossws-xfire.sar"/>
			<!-- Undeploy juddi-service.sar -->
			<delete dir="${jboss42.home}/server/${jboss.server.instance}/deploy/juddi-service.sar"/>
    </sequential>
  </macrodef>
  
</project>
