<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!--                                                                        -->
<!--  JBoss, the OpenSource J2EE webOS                                      -->
<!--                                                                        -->
<!--  Distributable under LGPL license.                                     -->
<!--  See terms of license at http://www.gnu.org.                           -->
<!--                                                                        -->
<!-- ====================================================================== -->

<project>

  <!-- ================================================================== -->
  <!-- Prepare Deployment Structure JBoss-5.1.x                           -->
  <!-- ================================================================== -->

  <target name="deploy-structure-jboss51" depends="prepare-deploy">
    <delete dir="${deploy.structure}"/>
  	<!-- all -->
    <antcall target="deploy-jbossws-cxf51" inheritall="false">
      <param name="installserver" value="${deploy.structure}/server/all"/>
      <param name="jbossid" value="jboss510"/>
      <param name="artifactsdir" value="${deploy.artifacts.dir}"/>
      <param name="thirdpartydir" value="${deploy.artifacts.dir}"/>
    </antcall>
  	<!-- standard -->
    <antcall target="deploy-jbossws-cxf51" inheritall="false">
      <param name="installserver" value="${deploy.structure}/server/standard"/>
      <param name="jbossid" value="jboss510"/>
      <param name="artifactsdir" value="${deploy.artifacts.dir}"/>
      <param name="thirdpartydir" value="${deploy.artifacts.dir}"/>
    </antcall>
  	<!-- production -->
    <antcall target="deploy-jbossws-cxf51" inheritall="false">
      <param name="installserver" value="${deploy.structure}/server/production"/>
      <param name="jbossid" value="jboss510"/>
      <param name="artifactsdir" value="${deploy.artifacts.dir}"/>
      <param name="thirdpartydir" value="${deploy.artifacts.dir}"/>
    </antcall>
  	<!-- web -->
    <antcall target="deploy-jbossws-cxf51" inheritall="false">
      <param name="installserver" value="${deploy.structure}/server/web"/>
      <param name="jbossid" value="jboss510"/>
      <param name="artifactsdir" value="${deploy.artifacts.dir}"/>
      <param name="thirdpartydir" value="${deploy.artifacts.dir}"/>
    </antcall>
  	<!-- default -->
    <antcall target="deploy-jbossws-cxf51" inheritall="false">
      <param name="installserver" value="${deploy.structure}/server/default"/>
      <param name="jbossid" value="jboss510"/>
      <param name="artifactsdir" value="${deploy.artifacts.dir}"/>
      <param name="thirdpartydir" value="${deploy.artifacts.dir}"/>
    </antcall>
  </target>

  <!-- ================================================================== -->
  <!-- Deployment JBoss510                                                -->
  <!-- ================================================================== -->

  <target name="deploy-jboss510" depends="undeploy-jboss510,deploy-structure-jboss51">
    <fail message="Please make sure you're running this script from $JBOSS_HOME/jbossws-cxf-installer" unless="jboss510.available"/>
    <copy todir="${jboss510.home}" overwrite="true">
      <fileset dir="${deploy.structure}"/>
    </copy>
    <chmod dir="${jboss510.home}/bin" perm="+x" includes="*.sh"/>
  </target>

  <target name="undeploy-jboss510" depends="init">
    <fail message="Please make sure you're running this script from your $JBOSS_HOME/jbossws-cxf-installer" unless="jboss510.available"/>
    <macro-undeploy-jbossws51 targetdir="${jboss510.home}/server/all/deploy/jbossws.sar" defaultconf="${jbossws.all.deploy.conf}"/>
    <macro-undeploy-jbossws51 targetdir="${jboss510.home}/server/production/deploy/jbossws.sar" defaultconf="${jbossws.production.deploy.conf}"/>
	<macro-undeploy-jbossws51 targetdir="${jboss510.home}/server/web/deploy/jbossws.sar" defaultconf="${jbossws.web.deploy.conf}"/>
    <macro-undeploy-jbossws51 targetdir="${jboss510.home}/server/standard/deploy/jbossws.sar" defaultconf="${jbossws.standard.deploy.conf}"/>
	<macro-undeploy-jbossws51 targetdir="${jboss510.home}/server/default/deploy/jbossws.sar" defaultconf="${jbossws.default.deploy.conf}"/>
  </target>

</project>
