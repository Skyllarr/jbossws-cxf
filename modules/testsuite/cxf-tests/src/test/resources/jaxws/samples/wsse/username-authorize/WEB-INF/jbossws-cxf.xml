<beans
  xmlns='http://www.springframework.org/schema/beans'
  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
  xmlns:beans='http://www.springframework.org/schema/beans'
  xmlns:jaxws='http://cxf.apache.org/jaxws'
  xmlns:util='http://www.springframework.org/schema/util'
  xsi:schemaLocation='http://cxf.apache.org/core
    http://cxf.apache.org/schemas/core.xsd
    http://www.springframework.org/schema/util
    http://www.springframework.org/schema/util/spring-util-2.0.xsd
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
    http://cxf.apache.org/jaxws
    http://cxf.apache.org/schemas/jaxws.xsd'>
  
  <bean id="SecurityContextIn" class="org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor">
    <constructor-arg>
      <map>
        <entry key="action" value="UsernameToken"/> 
      </map>
    </constructor-arg>
  </bean>
 
  <util:map id="methodPermissions">
     <entry key="sayHello" value="friend"/> 
     <entry key="greetMe" value="snoopies"/> 
  </util:map>
 
  <bean id="AuthorizeIn" class="org.apache.cxf.interceptor.security.SimpleAuthorizingInterceptor">
   <property name="methodRolesMap" ref="methodPermissions"/> 
  </bean>
  
  <jaxws:endpoint
    id='ServiceImpl'
    address='http://@jboss.bind.address@:8080/jaxws-samples-wsse-username-authorize/default-config'
    implementor='org.jboss.test.ws.jaxws.samples.wsse.ServiceImpl'
    endpointName="ns:SecurityServicePort"
    serviceName="ns:SecurityService"
    xmlns:ns="http://www.jboss.org/jbossws/ws-extensions/wssecurity">
    <jaxws:inInterceptors>
        <ref bean="SecurityContextIn"/>
        <ref bean="AuthorizeIn"/>
        <bean class="org.apache.cxf.binding.soap.saaj.SAAJInInterceptor"/>
    </jaxws:inInterceptors>
  </jaxws:endpoint>
   
  <bean id="SecurityContextIn2" class="org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor">
    <constructor-arg>
      <map>
        <entry key="action" value="UsernameToken"/> 
      </map>
    </constructor-arg>
    <property name="securityConfigFile" value="login-config.xml"/>
    <property name="securityDomainName" value="custom"/>
  </bean>
 
  <util:map id="methodPermissions2">
     <entry key="sayHello" value="theFriends"/> 
     <entry key="greetMe" value="theSnoopies"/> 
  </util:map>
 
  <bean id="AuthorizeIn2" class="org.apache.cxf.interceptor.security.SimpleAuthorizingInterceptor">
   <property name="methodRolesMap" ref="methodPermissions2"/> 
  </bean>
  
  <jaxws:endpoint
    id='ServiceImpl2'
    address='http://@jboss.bind.address@:8080/jaxws-samples-wsse-username-authorize/custom-config'
    implementor='org.jboss.test.ws.jaxws.samples.wsse.ServiceImpl'
    endpointName="ns:SecurityServicePort2"
    serviceName="ns:SecurityService"
    xmlns:ns="http://www.jboss.org/jbossws/ws-extensions/wssecurity">
    <jaxws:inInterceptors>
        <ref bean="SecurityContextIn2"/>
        <ref bean="AuthorizeIn2"/>
        <bean class="org.apache.cxf.binding.soap.saaj.SAAJInInterceptor"/>
    </jaxws:inInterceptors>
  </jaxws:endpoint>  
    
</beans>
