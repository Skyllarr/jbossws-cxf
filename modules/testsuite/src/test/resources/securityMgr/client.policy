// Permissions for jbossws cxf test suite

// Trusted core Java code
grant codeBase "file:${java.home}/lib/ext/-" {
   permission java.security.AllPermission;
};

//for javac
grant codeBase "file:${java.home}/../lib" {
   permission java.security.AllPermission;
};

grant codeBase "file:${java.home}/lib/-" {
   permission java.security.AllPermission;
};


grant {
  //allow surefire to read compiled class in target dir, WSConsumerTestCase javac needs execute permission
  permission java.io.FilePermission "<<ALL FILES>>", "execute,read";
  permission java.util.PropertyPermission "*", "read,write";
  permission java.util.logging.LoggingPermission "control";
  //for test
  permission java.lang.reflect.ReflectPermission "suppressAccessChecks";
  permission java.lang.RuntimePermission "accessDeclaredMembers";
  permission java.net.SocketPermission "*", "connect,resolve";
  permission java.lang.RuntimePermission "createClassLoader";
  permission java.lang.RuntimePermission "setContextClassLoader";
  permission java.lang.RuntimePermission "org.jboss.security.getSecurityContext";
  permission java.lang.RuntimePermission "org.jboss.security.plugins.JBossSecurityContext.getSubjectInfo";
  permission java.lang.RuntimePermission "setIO";
  permission java.lang.RuntimePermission "setFactory";
  permission java.lang.RuntimePermission "modifyThreadGroup";

  permission java.lang.RuntimePermission "org.jboss.security.SecurityAssociation.getPrincipalInfo";
  permission java.lang.RuntimePermission "org.jboss.security.plugins.JBossSecurityContext.setSubjectInfo";
  
  permission org.jboss.metadata.spi.stack.MetaDataStackPermission "*";
  permission java.lang.RuntimePermission "org.jboss.security.setSecurityContext";
  permission java.lang.RuntimePermission "createSecurityManager";
  //AsymmetricBindingClientTestCase
  permission java.security.SecurityPermission "insertProvider.BC";
  permission java.security.SecurityPermission "putProviderProperty.BC";
  permission java.lang.RuntimePermission "getClassLoader";

  permission java.lang.RuntimePermission "accessClassInPackage.*";
  permission java.io.SerializablePermission "enableSubstitution";
  permission javax.xml.ws.WebServicePermission "publishEndpoint";
  permission java.lang.RuntimePermission "getenv.*";

  permission java.io.FilePermission "${java.home}/-", "execute";

  permission java.io.FilePermission "${jboss.home}/bin/-", "execute";

  permission java.net.SocketPermission "*","accept,listen,resolve";
  permission java.security.SecurityPermission "getPolicy";
  permission java.security.SecurityPermission "getAccessControlContext";

  permission java.io.FilePermission "${target.dir}/-", "write,delete";

  //WSConsumerTestCase
  permission java.io.FilePermission "./-", "write,delete";
  permission java.io.FilePermission "/tmp", "write,delete";
  permission java.io.FilePermission "/tmp/-", "write,delete";
  permission java.lang.RuntimePermission "shutdownHooks";
  permission java.lang.RuntimePermission "getProtectionDomain";
};




