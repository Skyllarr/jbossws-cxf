  
  <!-- The registry for web service endpoints -->
  <bean name="WSEndpointRegistry" class="org.jboss.wsf.framework.management.ManagedEndpointRegistry">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
  </bean>
  
  <!-- Logging redirector -->
  <bean name="JDKLogRedirector" class="org.jboss.wsf.common.logging.JDKLogRedirector">
    <property name="namespaces">
      <list class="java.util.LinkedList" elementClass="java.lang.String">
        <value>org.apache.cxf</value>
      </list>
    </property>
  </bean>

  <!-- Installed Record Processors-->
  <bean name="WSMemoryBufferRecorder" class="org.jboss.wsf.framework.management.recording.MemoryBufferRecorder">
    <property name="recording">false</property>
  </bean>
  <bean name="WSLogRecorder" class="org.jboss.wsf.framework.management.recording.LogRecorder">
    <property name="recording">false</property>
  </bean>

  <!-- 
    The stack specific deployment aspects
  --> 
  <bean name="WSCXFContextPropertiesDeploymentAspect" class="org.jboss.wsf.framework.deployment.ContextPropertiesDeploymentAspect">
    <property name="provides">ContextProperties</property>
    <property name="contextProperties">
      <map keyClass="java.lang.String" valueClass="java.lang.String">
        <entry><key>org.jboss.ws.webapp.ServletClass</key><value>org.jboss.wsf.stack.cxf.CXFServletExt</value></entry>
      </map>
    </property>
  </bean>

  <bean name="WSCXFDescriptorDeploymentAspect" class="org.jboss.wsf.stack.cxf.DescriptorDeploymentAspect">
    <property name="requires">EndpointAddress</property>
    <property name="provides">StackDescriptor</property>
    <property name="invokerEJB3">org.jboss.wsf.stack.cxf.InvokerEJB3</property>
    <property name="invokerJSE">org.jboss.wsf.stack.cxf.InvokerJSE</property>
  </bean>

  <bean name="WSCXFEndpointHandlerDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointHandlerDeploymentAspect">
    <property name="requires">ContainerEndpointHandler</property>
    <property name="provides">StackEndpointHandler</property>        
  </bean>

  <bean name="WSCXFEndpointRecordProcessorDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointRecordProcessorDeploymentAspect">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
    <property name="requires">RegisteredEndpoint</property>
    <property name="provides">EndpointRecordProcessors</property>
    <property name="processors">
      <list class="java.util.ArrayList" elementClass="org.jboss.wsf.spi.management.recording.RecordProcessor">
        <inject bean="WSMemoryBufferRecorder"/>
        <inject bean="WSLogRecorder"/>
      </list>
    </property>
  </bean>

  <!-- Deployment aspect installers -->  

  <!-- Phase 2 -->
  <bean name="WSCXFDeploymentAspectInstallerPreJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
    <property name="manager"><inject bean="WSDeploymentAspectManagerPreJSE"/></property>
    <property name="sortAspectsOnCreate">true</property>
    <property name="aspects">
      <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
        <inject bean="WSCXFContextPropertiesDeploymentAspect"/>
        <inject bean="WSCXFDescriptorDeploymentAspect"/>
      </set>
    </property>
    <depends>WSDeploymentAspectInstallerPreJSE</depends>
  </bean>

  <!-- Phase 2 -->
  <bean name="WSCXFDeploymentAspectInstallerPostJSE" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
    <property name="manager"><inject bean="WSDeploymentAspectManagerPostJSE"/></property>
    <property name="sortAspectsOnCreate">true</property>
    <property name="aspects">
      <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">        
        <inject bean="WSCXFEndpointHandlerDeploymentAspect"/>
        <inject bean="WSCXFEndpointRecordProcessorDeploymentAspect"/>
      </set>
    </property>
    <depends>WSDeploymentAspectInstallerPostJSE</depends>
  </bean>

  <bean name="WSCXFDeploymentAspectInstallerEJB" class="org.jboss.wsf.framework.deployment.DeploymentAspectInstaller">
    <property name="manager"><inject bean="WSDeploymentAspectManagerEJB"/></property>
    <property name="sortAspectsOnCreate">true</property>
    <property name="aspects">
      <set class="java.util.HashSet" elementClass="org.jboss.wsf.spi.deployment.DeploymentAspect">
        <inject bean="WSCXFContextPropertiesDeploymentAspect"/>
        <inject bean="WSCXFEndpointHandlerDeploymentAspect"/>
        <inject bean="WSCXFEndpointRecordProcessorDeploymentAspect"/>
        <inject bean="WSCXFDescriptorDeploymentAspect"/>
      </set>
    </property>
    <depends>WSDeploymentAspectInstallerEJB</depends>
  </bean>
    
